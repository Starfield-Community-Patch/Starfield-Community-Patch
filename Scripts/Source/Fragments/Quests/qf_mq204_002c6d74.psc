ScriptName Fragments:Quests:QF_MQ204_002C6D74 Extends Quest Const hidden

;-- Variables ---------------------------------------

;-- Properties --------------------------------------
ObjectReference Property LodgeStartMarker Auto Const mandatory
ReferenceAlias Property Alias_Vladimir Auto Const mandatory
ObjectReference Property MQ106_VladimirMarker01 Auto Const mandatory
ReferenceAlias Property Alias_SamCoe Auto Const mandatory
GlobalVariable Property MQ101Debug Auto Const mandatory
Quest Property MQ101 Auto Const mandatory
ObjectReference Property MQ106_SamMarker01 Auto Const mandatory
Scene Property MQ204A_004_NoelAmbient Auto Const mandatory
ReferenceAlias Property Alias_SarahMorgan Auto Const mandatory
ObjectReference Property MQ204EyeMovetoMarker Auto Const mandatory
ReferenceAlias Property Alias_LodgeFrontDoor Auto Const mandatory
Scene Property MQ204A_007_ActivateDoor Auto Const mandatory
Scene Property MQ204A_008_NoelPackUp Auto Const mandatory
ObjectReference Property MQ204HunterArrivesMarker Auto Const mandatory
ReferenceAlias Property Alias_TheHunter Auto Const mandatory
Scene Property MQ204A_009_HunterArrives Auto Const mandatory
Scene Property MQ204A_010_HunterBleedout Auto Const mandatory
Scene Property MQ204A_012_Tunnel Auto Const mandatory
Message Property MQ204MedStimMSG Auto Const mandatory
Scene Property MQ204A_014_Vladimir Auto Const mandatory
Scene Property MQ204A_016_ReturnScene Auto Const mandatory
ActorValue Property MQ204UCGuard Auto Const mandatory
ReferenceAlias Property Alias_Noel Auto Const mandatory
Faction Property PlayerEnemyFaction Auto Const mandatory
Scene Property MQ204A_031_MedstimSarah Auto Const mandatory
Quest Property MQ102 Auto Const mandatory
ObjectReference Property MQ204_NoelHidingMarker Auto Const mandatory
ReferenceAlias Property MQ00_CompanionAtLodge Auto Const
ReferenceAlias Property MQ00_CompanionAtEye Auto Const
Scene Property MQ204A_010_ArtifactPackUp Auto Const mandatory
Scene Property MQ204A_012b_InCity Auto Const mandatory
ReferenceAlias Property MQ00_CompanionWhoDies Auto Const
ReferenceAlias Property Alias_CompanionAtEye Auto Const mandatory
ReferenceAlias Property Alias_CompanionAtLodge Auto Const mandatory
ReferenceAlias Property Alias_WalterStroud Auto Const mandatory
ReferenceAlias Property Alias_CoraCoe Auto Const mandatory
ReferenceAlias Property Alias_Andreja Auto Const mandatory
ReferenceAlias Property Alias_Barrett Auto Const mandatory
ReferenceAlias Property Alias_Vasco Auto Const mandatory
ReferenceAlias Property Alias_MatteoKhatri Auto Const mandatory
ReferenceAlias Property Alias_LodgeRoofDoor Auto Const mandatory
ObjectReference Property Frontier_ModularREF Auto Const mandatory
Quest Property SQ_PlayerShip Auto Const mandatory
ObjectReference Property NewAtlantisShipLandingMarker Auto Const mandatory
Keyword Property SpaceshipEnabledLandingLink Auto Const mandatory
ReferenceAlias Property MQ00_CompanionWhoLives Auto Const
Quest Property MQ206B Auto Const mandatory
Scene Property MQ204A_051_LodgeReturnScene Auto Const mandatory
Faction Property ConstellationFaction Auto Const mandatory
Scene Property MQ204A_012c_InShip Auto Const mandatory
Scene Property MQ204A_015a_CoraScene Auto Const mandatory
Quest Property MQ202 Auto Const mandatory
Quest Property MQ206A Auto Const mandatory
ObjectReference Property MQ101_PlayerMarker01 Auto Const mandatory
ObjectReference Property MQ204_NA_HunterMarker Auto Const mandatory
ObjectReference Property MQ204_NA_PlayerMarker Auto Const mandatory
GlobalVariable Property COM_CompanionID_SarahMorgan Auto Const mandatory
GlobalVariable Property COM_CompanionID_SamCoe Auto Const mandatory
GlobalVariable Property COM_CompanionID_Barret Auto Const mandatory
GlobalVariable Property COM_CompanionID_Andreja Auto Const mandatory
GlobalVariable Property MQ_CompanionDead Auto Const mandatory
GlobalVariable Property COM_CompanionID_Barrett Auto Const mandatory
ActorValue Property Health Auto Const mandatory
Spell Property MQ204HunterInvisibility Auto Const mandatory
Faction Property CurrentCompanionFaction Auto Const mandatory
Scene Property MQ204A_031_MedstimAndreja Auto Const mandatory
Scene Property MQ204A_031_MedstimBarrett Auto Const mandatory
Scene Property MQ204A_031_MedstimMatteo Auto Const mandatory
Scene Property MQ204A_030a_DeathCoraScene Auto Const mandatory
Scene Property MQ204A_020a_MedstimSam Auto Const mandatory
ReferenceAlias Property Alias_Companion Auto Const mandatory
Quest Property SQ_Companions Auto Const mandatory
Scene Property MQ204A_052_ScorpiusScene Auto Const mandatory
ReferenceAlias Property Alias_TheScorpius Auto Const mandatory
ObjectReference Property MQ204ScorpiusMarker Auto Const mandatory
ObjectReference Property MQ204_Stage200EyeMarker_Noel Auto Const mandatory
ReferenceAlias Property Alias_ArtifactCollectionTrigger Auto Const mandatory
Faction Property AvailableCompanionFaction Auto Const mandatory
Scene Property MQ204A_037_PlayerInShip Auto Const mandatory
Quest Property MQ204xPostQuest Auto Const mandatory
ObjectReference Property MQ204Start Auto Const mandatory
ObjectReference Property JemisonGuardShipsEnableMarker Auto Const mandatory
Scene Property MQ204A_008a_NoelPackUp Auto Const mandatory
Key Property LodgeKey Auto Const mandatory
ObjectReference Property MQ204LodgeAttackClutterEnableMarker Auto Const mandatory
ObjectReference Property MQ204BasementDoorEnableMarker Auto Const mandatory
Key Property MQ204WellKey Auto Const mandatory
Quest Property SQ_Followers Auto Const mandatory
Scene Property MQ204A_011b_EveryoneRuns Auto Const mandatory
Faction Property CrimeFactionUC Auto Const mandatory
ObjectReference Property EyeMarker Auto Const mandatory
ObjectReference Property MQ204SecretDoorREF Auto Const mandatory
Spell Property abAIPower_MoonForm_Hunter Auto Const mandatory
Perk Property crModIncomingDamage00 Auto Const mandatory
Scene Property MQ204A_012c_Spaceport Auto Const mandatory
Scene Property MQ204A_013_HunterScene01 Auto Const mandatory
Scene Property MQ204A_013_HunterScene02 Auto Const mandatory
ObjectReference Property MQ204DoortoLodgeREF Auto Const mandatory
Faction Property UCSecurityFaction Auto Const mandatory
ObjectReference Property UC04_Spaceport_WarningSign_EnableMarker Auto Const mandatory
Scene Property MQ204A_013_HunterScene01b Auto Const mandatory
ObjectReference Property MQ204_BarricadeEnableMarker Auto Const mandatory
MusicType Property MUSGenesisStingerDread1Small Auto Const mandatory
ObjectReference Property ArmillaryMountSwapEnableMarker Auto Const mandatory
ObjectReference Property MQ204EyeAttackEnableMarker Auto Const mandatory
ReferenceAlias Property Alias_LodgeFrontDoorExterior Auto Const mandatory
ReferenceAlias Property Alias_LodgeRoofDoorExterior Auto Const mandatory
ObjectReference Property MQHoldingCellCenterMarker Auto Const mandatory
Explosion Property LC165_ScriptedTeleportSourceExplosion Auto Const mandatory
LeveledItem Property MQ204HunterReward Auto Const mandatory
Scene Property MQ204A_060_HunterGoneScene Auto Const mandatory
ActorValue Property MQ204SamDied Auto Const mandatory
ReferenceAlias Property Alias_PlayerShipInventory Auto Const mandatory
MiscObject Property Mfg_Tier01_Structural_Frame Auto Const mandatory
Faction Property EyeBoardingFaction Auto Const mandatory
Message Property TestMQ204MSG Auto Const mandatory
Message Property TestMQ204MSG02 Auto Const mandatory
Faction Property MQ204RunningGroupFaction Auto Const mandatory
Keyword Property AnimFaceArchetypeAfraid Auto Const mandatory
Message Property MQ204ArmillaryAttackMSG Auto Const mandatory
Keyword Property AnimFaceArchetypeDying Auto Const mandatory
Scene Property MQ204A_008b_WalterChoking Auto Const mandatory
ReferenceAlias Property Alias_SpaceportShip Auto Const mandatory
Quest Property CF05 Auto Const mandatory
Quest Property FFNewAtlantis05 Auto Const mandatory
ObjectReference Property MQ204HunterWalterMarkerREF Auto Const mandatory
Scene Property MQ204A_008b_WalterGrabbed Auto Const mandatory
Quest Property SQ_Crew Auto Const mandatory
Scene Property MQ204A_036b_EveryoneRuns Auto Const mandatory
Scene Property MQ204A_012d_InShip Auto Const mandatory
GlobalVariable Property MQ_CompanionSaved Auto Const mandatory
ReferenceAlias Property Alias_LodgeInteriorDoor Auto Const mandatory
Location Property CityNewAtlantisLocation Auto Const mandatory
Location Property CityNewAtlantisWellLocation Auto Const mandatory
GlobalVariable Property MQ204_TurnOffCF01Arrest Auto Const mandatory
ReferenceAlias Property Alias_PreMQ106Hunter Auto Const mandatory
Spell Property AbStarbornDeath Auto Const mandatory
Spell Property AbStarbornTeleport Auto Const mandatory
Message Property MQ204CompanionLockInMSG Auto Const mandatory
Message Property MQ204CompanionLockInMidquestLodgeMSG Auto Const mandatory
Message Property MQ204CompanionLockInMidquestEyeMSG Auto Const mandatory
Message Property MQ204CompanionLockInOverMSG Auto Const mandatory
Quest Property MQMisc02 Auto Const mandatory
Spell Property ffStarbornTeleport Auto Const mandatory
ReferenceAlias Property Alias_Armillary Auto Const mandatory
ReferenceAlias Property Alias_LodgeDisplay Auto Const mandatory
GlobalVariable Property MQAlllowArmillaryGravDrive Auto Const mandatory
Message Property MQ204ArmillaryBuildMSG Auto Const mandatory
Quest Property MQ204_NA_StateChangeHandler Auto Const mandatory
ObjectReference Property NewAtlantisMapMarkerLodge Auto Const mandatory
ObjectReference Property NewAtlantisMapMarkerCommercialDistrict Auto Const mandatory
ObjectReference Property NewAtlantisMapMarkerWestEnd Auto Const mandatory
ObjectReference Property NewAtlantisMapMarkerEmbassy Auto Const mandatory
ObjectReference Property NewAtlantisMapMarkerResidentialDistrict Auto Const mandatory
MusicType Property MUSGenesisStingerStarbornAppearC Auto Const mandatory
ObjectReference Property MQ204_WellEnableState Auto Const mandatory
ObjectReference Property MQ204_NoelWellEscort_Marker Auto Const mandatory
ObjectReference Property MQ204_RunMarker_Walter02 Auto Const mandatory
ObjectReference Property MQ204_RunMarker_Companion02 Auto Const mandatory
ObjectReference Property MQ204_RunMarker_Vasco02 Auto Const mandatory
ObjectReference Property MQ204_RunMarker_Matteo02 Auto Const mandatory
ObjectReference Property MQ204_RunMarker_Walter03 Auto Const mandatory
ObjectReference Property MQ204_RunMarker_Matteo03 Auto Const mandatory
ObjectReference Property MQ204_RunMarker_Companion03 Auto Const mandatory
ObjectReference Property MQ204NoelRuntoSpaceport Auto Const mandatory
ObjectReference Property MQ204_RunMarker_Vasco03 Auto Const mandatory
Faction Property MQ204UCAllyFaction Auto Const mandatory
Scene Property MQ204A_011_NoelRuns Auto Const mandatory
ObjectReference Property MQ204_Stage200EyeMarker_Vladimir Auto Const mandatory
ReferenceAlias Property Alias_PlayerShip Auto Const mandatory
ReferenceAlias Property Alias_HomeShipArmillaryScreenTrigger Auto Const mandatory
ReferenceAlias Property Alias_WellElevatorManagerToMAST Auto Const mandatory
ReferenceAlias Property Alias_WellElevatorFloor_Well Auto Const mandatory
ReferenceAlias Property Alias_WellElevatorFloor_Waterfall Auto Const mandatory
Keyword Property AnimFaceArchetypeEyesClosed Auto Const mandatory
ObjectReference Property MQ204_RunMarker_Cora02 Auto Const mandatory
ObjectReference Property MQ204_RunMarker_Cora03 Auto Const mandatory
ReferenceAlias Property Alias_PlayerPassengerMarker Auto Const mandatory
EffectShader Property Starborn_DeathShader Auto Const mandatory
Quest Property COM_Quest_Andreja_Q01 Auto Const mandatory
Quest Property COM_Quest_Barrett_Q01 Auto Const mandatory
Quest Property COM_Quest_Barrett_Q02 Auto Const mandatory
Quest Property COM_Quest_SamCoe_Q01 Auto Const mandatory
Quest Property COM_Quest_SarahMorgan_Q01 Auto Const mandatory
Quest Property FFLodge01 Auto Const mandatory
Quest Property FFLodge02 Auto Const mandatory
Quest Property FFLodge03 Auto Const mandatory
ObjectReference Property MQ204LodgeDeathMarker Auto Const mandatory
ObjectReference Property MQ204_EyeDeathMarker Auto Const mandatory
MusicType Property MUSGenesisCombatBoss_MQ204_A_Hunter Auto Const mandatory
Scene Property MQ204A_008c_WalterChoking Auto Const mandatory
ObjectReference Property MQ204EyeCompanionDeadEnableMarker Auto Const mandatory
ObjectReference Property MQ204LodgeCompanionDeadEnableMarker Auto Const mandatory
ObjectReference Property MQ204LodgeDeathNearMarker Auto Const mandatory
ReferenceAlias Property Alias_Sona Auto Const mandatory
GlobalVariable Property COM_SQ01_SonaLeft Auto Const mandatory
Quest Property MQ201B Auto Const mandatory
Quest Property MQ404 Auto Const mandatory
affinityevent Property COM_WantsToTalkEvent_MQ204 Auto Const mandatory
ActorValue Property CrewReassignDisabled Auto Const mandatory
RefCollectionAlias Property DismissedCrew Auto Const
RefCollectionAlias Property DisembarkingCrew Auto Const
wwiseevent Property WwiseEvent_QST_MQ204_Starborn_VoidForm_End Auto Const mandatory
Quest Property COM_Companion_SamCoe Auto Const mandatory
Quest Property COM_Companion_SarahMorgan Auto Const mandatory
Quest Property Com_Companion_Barrett Auto Const mandatory
Quest Property COM_Companion_Andreja Auto Const mandatory
ReferenceAlias[] Property Alias_Companions Auto Const mandatory
GlobalVariable Property COM_WantsToTalk_CooldownDays Auto Const mandatory
ActorValue Property COM_WantsToTalk_MQ204_Cooldown Auto Const mandatory
ActorValue Property COM_IsRomantic Auto Const mandatory
ActorValue Property COM_IsCommitted Auto Const mandatory
ReferenceAlias Property Alias_LodgeSecretDoor Auto Const mandatory
Quest Property SQ_GuardShips Auto Const mandatory
Quest Property SQ_GuardShips00 Auto Const mandatory
Quest Property SQ_GuardShips01 Auto Const mandatory
ObjectReference Property NewAtlantisMapMarkerSpaceport Auto Const mandatory

;-- Functions ---------------------------------------

Function Fragment_Stage_0000_Item_00()
  Actor SamCoeREF = Alias_SamCoe.GetActorRef()
  Actor SarahMorganREF = Alias_SarahMorgan.GetActorRef()
  Actor AndrejaREF = Alias_Andreja.GetActorRef()
  Actor BarrettREF = Alias_Barrett.GetActorRef()
  Actor CompanionLodgeREF = None
  Actor CompanionEyeREF = None
  (Alias_ArtifactCollectionTrigger.GetRef().GetLinkedRef(None) as armillaryscript).DebugSetArtifactAdded(0)
  (Alias_ArtifactCollectionTrigger.GetRef().GetLinkedRef(None) as armillaryscript).DebugSetArtifactAdded(5)
  (Alias_ArtifactCollectionTrigger.GetRef().GetLinkedRef(None) as armillaryscript).DebugSetArtifactAdded(18)
  (Alias_ArtifactCollectionTrigger.GetRef().GetLinkedRef(None) as armillaryscript).DebugSetArtifactAdded(3)
  (Alias_ArtifactCollectionTrigger.GetRef().GetLinkedRef(None) as armillaryscript).DebugSetArtifactAdded(4)
  (Alias_ArtifactCollectionTrigger.GetRef().GetLinkedRef(None) as armillaryscript).DebugSetArtifactAdded(5)
  (Alias_ArtifactCollectionTrigger.GetRef().GetLinkedRef(None) as armillaryscript).DebugSetArtifactAdded(6)
  (Alias_ArtifactCollectionTrigger.GetRef().GetLinkedRef(None) as armillaryscript).DebugSetArtifactAdded(7)
  (Alias_ArtifactCollectionTrigger.GetRef().GetLinkedRef(None) as armillaryscript).DebugSetArtifactAdded(8)
  (Alias_ArtifactCollectionTrigger.GetRef().GetLinkedRef(None) as armillaryscript).DebugSetArtifactAdded(9)
  Int ButtonPressed = TestMQ204MSG.Show(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)
  If ButtonPressed == 0
    CompanionLodgeREF = SarahMorganREF
  ElseIf ButtonPressed == 1
    CompanionLodgeREF = SamCoeREF
  ElseIf ButtonPressed == 2
    CompanionLodgeREF = AndrejaREF
  ElseIf ButtonPressed == 3
    CompanionLodgeREF = BarrettREF
  EndIf
  Utility.Wait(0.100000001)
  ButtonPressed = TestMQ204MSG02.Show(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)
  If ButtonPressed == 0
    CompanionEyeREF = SarahMorganREF
  ElseIf ButtonPressed == 1
    CompanionEyeREF = SamCoeREF
  ElseIf ButtonPressed == 2
    CompanionEyeREF = AndrejaREF
  ElseIf ButtonPressed == 3
    CompanionEyeREF = BarrettREF
  EndIf
  Utility.Wait(0.100000001)
  While CompanionLodgeREF == CompanionEyeREF
    ButtonPressed = TestMQ204MSG02.Show(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)
    If ButtonPressed == 0
      CompanionEyeREF = SarahMorganREF
    ElseIf ButtonPressed == 1
      CompanionEyeREF = SamCoeREF
    ElseIf ButtonPressed == 2
      CompanionEyeREF = AndrejaREF
    ElseIf ButtonPressed == 3
      CompanionEyeREF = BarrettREF
    EndIf
    Utility.Wait(0.100000001)
  EndWhile
  MQ00_CompanionAtLodge.ForceRefTo(CompanionLodgeREF as ObjectReference)
  MQ00_CompanionAtEye.ForceRefTo(CompanionEyeREF as ObjectReference)
  (SQ_Companions as sq_companionsscript).SetRoleActive(CompanionLodgeREF, True, True, 0.0, 0.0)
  (SQ_Companions as sq_companionsscript).LockInCompanion(CompanionLodgeREF as companionactorscript, True, MQ204CompanionLockInMSG, None)
  MQ101Debug.SetValueInt(2)
  MQ101.SetStage(1800)
  MQ101.SetStage(1810)
  MQ102.CompleteQuest()
  MQ102.Stop()
  Frontier_ModularREF.moveto(NewAtlantisShipLandingMarker, 0.0, 0.0, 0.0, True, False)
  Frontier_ModularREF.setlinkedref(NewAtlantisShipLandingMarker, SpaceshipEnabledLandingLink, True)
  Frontier_ModularREF.Enable(False)
  (SQ_PlayerShip as sq_playershipscript).ResetHomeShip(Frontier_ModularREF as spaceshipreference)
  ArmillaryMountSwapEnableMarker.DisableNoWait(False)
  Game.Getplayer().moveto(LodgeStartMarker, 0.0, 0.0, 0.0, True, False)
  Game.Getplayer().addtoFaction(ConstellationFaction)
  Game.Getplayer().additem(LodgeKey as Form, 1, False)
  Game.Getplayer().addtoFaction(EyeBoardingFaction)
  MQ202.SetStage(500)
EndFunction

Function Fragment_Stage_0002_Item_00()
  MQ101Debug.SetValueInt(2)
  MQ101.SetStage(1800)
  MQ102.CompleteQuest()
  MQ102.Stop()
  Game.Getplayer().addtoFaction(ConstellationFaction)
  Game.Getplayer().moveto(LodgeStartMarker, 0.0, 0.0, 0.0, True, False)
  Game.Getplayer().addtoFaction(EyeBoardingFaction)
  Frontier_ModularREF.moveto(NewAtlantisShipLandingMarker, 0.0, 0.0, 0.0, True, False)
  Frontier_ModularREF.setlinkedref(NewAtlantisShipLandingMarker, SpaceshipEnabledLandingLink, True)
  Frontier_ModularREF.Enable(False)
  (SQ_PlayerShip as sq_playershipscript).ResetHomeShip(Frontier_ModularREF as spaceshipreference)
  Self.SetStage(70)
EndFunction

Function Fragment_Stage_0003_Item_00()
  Game.Getplayer().moveto(MQ204_NA_PlayerMarker, 0.0, 0.0, 0.0, True, False)
  Actor HunterREF = Alias_TheHunter.GetActorRef()
  HunterREF.moveto(MQ204_NA_HunterMarker, 0.0, 0.0, 0.0, True, False)
  HunterREF.addtoFaction(PlayerEnemyFaction)
  Game.Getplayer().addtoFaction(EyeBoardingFaction)
EndFunction

Function Fragment_Stage_0004_Item_00()
  Quest __temp = Self as Quest
  mq204script kmyQuest = __temp as mq204script
  MQ101Debug.SetValueInt(2)
  MQ101.SetStage(1800)
  MQ101.SetStage(1810)
  MQ102.CompleteQuest()
  MQ102.Stop()
  Game.Getplayer().moveto(EyeMarker, 0.0, 0.0, 0.0, True, False)
  Game.Getplayer().addtoFaction(ConstellationFaction)
  Game.Getplayer().additem(LodgeKey as Form, 1, False)
  Self.SetStage(100)
  Self.SetStage(135)
  Self.SetStage(140)
  Self.SetObjectiveCompleted(90, True)
  Self.SetStage(145)
  Game.Getplayer().addtoFaction(EyeBoardingFaction)
  MQ204A_012d_InShip.Stop()
  Actor SavedCompanionREF = MQ00_CompanionWhoLives.GetActorRef()
  If SavedCompanionREF == Alias_Andreja.GetActorRef()
    MQ_CompanionSaved.SetValueInt(COM_CompanionID_Andreja.GetValueInt())
  ElseIf SavedCompanionREF == Alias_Barrett.GetActorRef()
    MQ_CompanionSaved.SetValueInt(COM_CompanionID_Barrett.GetValueInt())
  ElseIf SavedCompanionREF == Alias_SamCoe.GetActorRef()
    MQ_CompanionSaved.SetValueInt(COM_CompanionID_SamCoe.GetValueInt())
  ElseIf SavedCompanionREF == Alias_SarahMorgan.GetActorRef()
    MQ_CompanionSaved.SetValueInt(COM_CompanionID_SarahMorgan.GetValueInt())
  EndIf
  MQ00_CompanionWhoDies.GetActorRef().ChangeAnimFaceArchetype(AnimFaceArchetypeEyesClosed)
EndFunction

Function Fragment_Stage_0005_Item_00()
  Quest __temp = Self as Quest
  mq204script kmyQuest = __temp as mq204script
  MQ101Debug.SetValueInt(2)
  MQ101.SetStage(1800)
  MQ101.SetStage(1810)
  MQ102.CompleteQuest()
  MQ102.Stop()
  Self.SetStage(70)
  Self.SetStage(400)
  Self.SetStage(420)
  Self.SetStage(440)
  Self.SetStage(450)
  Self.SetStage(460)
  Actor SavedCompanionREF = MQ00_CompanionWhoLives.GetActorRef()
  If SavedCompanionREF == Alias_Andreja.GetActorRef()
    MQ_CompanionSaved.SetValueInt(COM_CompanionID_Andreja.GetValueInt())
  ElseIf SavedCompanionREF == Alias_Barrett.GetActorRef()
    MQ_CompanionSaved.SetValueInt(COM_CompanionID_Barrett.GetValueInt())
  ElseIf SavedCompanionREF == Alias_SamCoe.GetActorRef()
    MQ_CompanionSaved.SetValueInt(COM_CompanionID_SamCoe.GetValueInt())
  ElseIf SavedCompanionREF == Alias_SarahMorgan.GetActorRef()
    MQ_CompanionSaved.SetValueInt(COM_CompanionID_SarahMorgan.GetValueInt())
  EndIf
  Frontier_ModularREF.moveto(NewAtlantisShipLandingMarker, 0.0, 0.0, 0.0, True, False)
  Frontier_ModularREF.setlinkedref(NewAtlantisShipLandingMarker, SpaceshipEnabledLandingLink, True)
  Frontier_ModularREF.Enable(False)
  (SQ_PlayerShip as sq_playershipscript).ResetHomeShip(Frontier_ModularREF as spaceshipreference)
  Game.Getplayer().moveto(LodgeStartMarker, 0.0, 0.0, 0.0, True, False)
  Game.Getplayer().addtoFaction(ConstellationFaction)
  Game.Getplayer().additem(LodgeKey as Form, 1, False)
  Game.Getplayer().addtoFaction(EyeBoardingFaction)
  MQ00_CompanionWhoDies.GetActorRef().ChangeAnimFaceArchetype(AnimFaceArchetypeEyesClosed)
EndFunction

Function Fragment_Stage_0007_Item_00()
  Actor SamCoeREF = Alias_SamCoe.GetActorRef()
  Actor SarahMorganREF = Alias_SarahMorgan.GetActorRef()
  Actor AndrejaREF = Alias_Andreja.GetActorRef()
  Actor BarrettREF = Alias_Barrett.GetActorRef()
  Actor CompanionLodgeREF = None
  Actor CompanionEyeREF = None
  CompanionLodgeREF = SarahMorganREF
  CompanionEyeREF = SamCoeREF
  MQ00_CompanionAtLodge.ForceRefTo(CompanionLodgeREF as ObjectReference)
  MQ00_CompanionAtEye.ForceRefTo(CompanionEyeREF as ObjectReference)
  (SQ_Companions as sq_companionsscript).SetRoleActive(CompanionLodgeREF, True, True, 0.0, 0.0)
  (SQ_Companions as sq_companionsscript).LockInCompanion(CompanionLodgeREF as companionactorscript, True, MQ204CompanionLockInMSG, None)
  MQ101Debug.SetValueInt(2)
  MQ101.SetStage(1800)
  MQ101.SetStage(1810)
  MQ102.CompleteQuest()
  MQ102.Stop()
  Frontier_ModularREF.moveto(NewAtlantisShipLandingMarker, 0.0, 0.0, 0.0, True, False)
  Frontier_ModularREF.setlinkedref(NewAtlantisShipLandingMarker, SpaceshipEnabledLandingLink, True)
  Frontier_ModularREF.Enable(False)
  (SQ_PlayerShip as sq_playershipscript).ResetHomeShip(Frontier_ModularREF as spaceshipreference)
  ArmillaryMountSwapEnableMarker.DisableNoWait(False)
  Game.Getplayer().moveto(LodgeStartMarker, 0.0, 0.0, 0.0, True, False)
  Game.Getplayer().addtoFaction(ConstellationFaction)
  Game.Getplayer().additem(LodgeKey as Form, 1, False)
  Game.Getplayer().addtoFaction(EyeBoardingFaction)
  Self.SetStage(6)
  Self.SetStage(70)
EndFunction

Function Fragment_Stage_0010_Item_00()
  Quest __temp = Self as Quest
  mq204script kmyQuest = __temp as mq204script
  Actor HunterREF = Alias_TheHunter.GetActorRef()
  Actor PlayerREF = Game.Getplayer()
  Actor AndrejaREF = Alias_Andreja.GetActorRef()
  Actor BarrettREF = Alias_Barrett.GetActorRef()
  Actor SamCoeREF = Alias_SamCoe.GetActorRef()
  Actor CoraCoeREF = Alias_CoraCoe.GetActorRef()
  Actor SarahMorganREF = Alias_SarahMorgan.GetActorRef()
  Actor VladimirREF = Alias_Vladimir.GetActorRef()
  PlayerREF.RemoveFromFaction(EyeBoardingFaction)
  If MQ00_CompanionAtLodge.GetActorRef() == None
    MQ00_CompanionAtLodge.ForceRefTo(SamCoeREF as ObjectReference)
  EndIf
  If MQ00_CompanionAtEye.GetActorRef() == None
    MQ00_CompanionAtEye.ForceRefTo(SarahMorganREF as ObjectReference)
  EndIf
  MQ204BasementDoorEnableMarker.Disable(False)
  MQ204EyeAttackEnableMarker.EnableNoWait(False)
  If FFNewAtlantis05.IsRunning() || CF05.IsRunning()
    Alias_SpaceportShip.GetRef().DisableNoWait(False)
  EndIf
  Alias_LodgeInteriorDoor.GetRef().Lock(False, False, True)
  Alias_PreMQ106Hunter.GetActorRef().Disable(False)
  Alias_LodgeDisplay.GetRef().PlayAnimation("Play02")
  FFLodge01.SetStage(200)
  FFLodge02.Stop()
  FFLodge03.Stop()
  If COM_SQ01_SonaLeft.GetValueInt() == 1
    Alias_Sona.GetActorRef().DisableNoWait(False)
  EndIf
EndFunction

Function Fragment_Stage_0020_Item_00()
  Quest __temp = Self as Quest
  mq204script kmyQuest = __temp as mq204script
  Actor AndrejaREF = Alias_Andreja.GetActorRef()
  Actor BarrettREF = Alias_Barrett.GetActorRef()
  Actor SamCoeREF = Alias_SamCoe.GetActorRef()
  Actor CoraCoeREF = Alias_CoraCoe.GetActorRef()
  Actor SarahMorganREF = Alias_SarahMorgan.GetActorRef()
  Actor VladimirREF = Alias_Vladimir.GetActorRef()
  Actor WalterREF = Alias_WalterStroud.GetActorRef()
  Actor MatteoREF = Alias_MatteoKhatri.GetActorRef()
  Actor VascoREF = Alias_Vasco.GetActorRef()
  Actor NoelREF = Alias_Noel.GetActorRef()
  Actor CompanionAtEyeREF = MQ00_CompanionAtEye.GetActorRef()
  Actor CompanionAtLodgeREF = MQ00_CompanionAtLodge.GetActorRef()
  (SQ_Companions as sq_companionsscript).SetRoleInactive(AndrejaREF, False, True, False)
  (SQ_Companions as sq_companionsscript).SetRoleInactive(BarrettREF, False, True, False)
  (SQ_Companions as sq_companionsscript).SetRoleInactive(SamCoeREF, False, True, False)
  (SQ_Companions as sq_companionsscript).SetRoleInactive(SarahMorganREF, False, True, False)
  (SQ_Crew as sq_crewscript).SetRoleInactive(AndrejaREF, False, True, False)
  (SQ_Crew as sq_crewscript).SetRoleInactive(BarrettREF, False, True, False)
  (SQ_Crew as sq_crewscript).SetRoleInactive(SamCoeREF, False, True, False)
  (SQ_Crew as sq_crewscript).SetRoleInactive(SarahMorganREF, False, True, False)
  (SQ_Crew as sq_crewscript).SetRoleInactive(VascoREF, False, True, False)
  DismissedCrew.RemoveRef(AndrejaREF as ObjectReference)
  DismissedCrew.RemoveRef(BarrettREF as ObjectReference)
  DismissedCrew.RemoveRef(SamCoeREF as ObjectReference)
  DismissedCrew.RemoveRef(SarahMorganREF as ObjectReference)
  DismissedCrew.RemoveRef(VascoREF as ObjectReference)
  DisembarkingCrew.RemoveRef(AndrejaREF as ObjectReference)
  DisembarkingCrew.RemoveRef(BarrettREF as ObjectReference)
  DisembarkingCrew.RemoveRef(SamCoeREF as ObjectReference)
  DisembarkingCrew.RemoveRef(SarahMorganREF as ObjectReference)
  DisembarkingCrew.RemoveRef(VascoREF as ObjectReference)
  If CompanionAtLodgeREF != AndrejaREF
    kmyQuest.MQ204MoveActor(AndrejaREF, EyeMarker)
  Else
    kmyQuest.MQ204MoveActor(AndrejaREF, LodgeStartMarker)
  EndIf
  If CompanionAtLodgeREF != SarahMorganREF
    kmyQuest.MQ204MoveActor(SarahMorganREF, EyeMarker)
  Else
    kmyQuest.MQ204MoveActor(SarahMorganREF, LodgeStartMarker)
  EndIf
  If CompanionAtLodgeREF != BarrettREF
    kmyQuest.MQ204MoveActor(BarrettREF, EyeMarker)
  Else
    kmyQuest.MQ204MoveActor(BarrettREF, LodgeStartMarker)
  EndIf
  If CompanionAtLodgeREF != SamCoeREF
    kmyQuest.MQ204MoveActor(SamCoeREF, EyeMarker)
  Else
    kmyQuest.MQ204MoveActor(SamCoeREF, LodgeStartMarker)
  EndIf
  If CompanionAtLodgeREF != SamCoeREF
    kmyQuest.MQ204MoveActor(CoraCoeREF, EyeMarker)
  Else
    kmyQuest.MQ204MoveActor(CoraCoeREF, LodgeStartMarker)
  EndIf
  kmyQuest.MQ204MoveActor(VladimirREF, EyeMarker)
  kmyQuest.MQ204MoveActor(WalterREF, LodgeStartMarker)
  kmyQuest.MQ204MoveActor(MatteoREF, LodgeStartMarker)
  kmyQuest.MQ204MoveActor(VascoREF, LodgeStartMarker)
  kmyQuest.MQ204MoveActor(NoelREF, LodgeStartMarker)
  AndrejaREF.SetValue(CrewReassignDisabled, 1.0)
  BarrettREF.SetValue(CrewReassignDisabled, 1.0)
  SamCoeREF.SetValue(CrewReassignDisabled, 1.0)
  SarahMorganREF.SetValue(CrewReassignDisabled, 1.0)
EndFunction

Function Fragment_Stage_0060_Item_00()
  Quest __temp = Self as Quest
  mq204script kmyQuest = __temp as mq204script
  kmyQuest.MQ204EnableLayer = inputenablelayer.Create()
  kmyQuest.MQ204EnableLayer.EnableFastTravel(False)
  kmyQuest.MQ204EnableLayer.EnableGravJump(False)
  Alias_LodgeFrontDoor.GetRef().BlockActivation(True, False)
  Alias_LodgeRoofDoor.GetRef().BlockActivation(True, False)
  ObjectReference SecretDoorREF = Alias_LodgeSecretDoor.GetRef()
  SecretDoorREF.BlockActivation(True, False)
  SecretDoorREF.Lock(True, False, True)
  SecretDoorREF.SetLockLevel(254)
  Actor AndrejaREF = Alias_Andreja.GetActorRef()
  Actor BarrettREF = Alias_Barrett.GetActorRef()
  Actor SamCoeREF = Alias_SamCoe.GetActorRef()
  Actor SarahMorganREF = Alias_SarahMorgan.GetActorRef()
  Actor VascoREF = Alias_Vasco.GetActorRef()
  (SQ_Companions as sq_companionsscript).SetRoleInactive(AndrejaREF, False, True, False)
  (SQ_Companions as sq_companionsscript).SetRoleInactive(BarrettREF, False, True, False)
  (SQ_Companions as sq_companionsscript).SetRoleInactive(SamCoeREF, False, True, False)
  (SQ_Companions as sq_companionsscript).SetRoleInactive(SarahMorganREF, False, True, False)
  (SQ_Crew as sq_crewscript).SetRoleInactive(AndrejaREF, False, True, False)
  (SQ_Crew as sq_crewscript).SetRoleInactive(BarrettREF, False, True, False)
  (SQ_Crew as sq_crewscript).SetRoleInactive(SamCoeREF, False, True, False)
  (SQ_Crew as sq_crewscript).SetRoleInactive(SarahMorganREF, False, True, False)
  (SQ_Crew as sq_crewscript).SetRoleInactive(VascoREF, False, True, False)
  MQ204A_004_NoelAmbient.Start()
  Alias_LodgeDisplay.GetRef().PlayAnimation("Play02")
  Self.SetStage(65)
EndFunction

Function Fragment_Stage_0065_Item_00()
  Quest __temp = Self as Quest
  mq204script kmyQuest = __temp as mq204script
  MQ202.SetStage(1000)
  Self.SetObjectiveDisplayed(50, True, False)
  MQ00_CompanionAtLodge.GetActorRef().ChangeAnimFaceArchetype(AnimFaceArchetypeAfraid)
  Alias_MatteoKhatri.GetActorRef().ChangeAnimFaceArchetype(AnimFaceArchetypeAfraid)
  Alias_Noel.GetActorRef().ChangeAnimFaceArchetype(AnimFaceArchetypeAfraid)
  Alias_WalterStroud.GetActorRef().ChangeAnimFaceArchetype(AnimFaceArchetypeAfraid)
  Self.SetActive(True)
EndFunction

Function Fragment_Stage_0066_Item_00()
  Alias_Armillary.GetRef().PlayAnimation("Collect")
  MQ204A_004_NoelAmbient.Stop()
EndFunction

Function Fragment_Stage_0067_Item_00()
  Alias_Armillary.GetRef().PlayAnimation("Activate")
EndFunction

Function Fragment_Stage_0068_Item_00()
  MQ204A_008b_WalterGrabbed.Start()
EndFunction

Function Fragment_Stage_0070_Item_00()
  Quest __temp = Self as Quest
  mq204script kmyQuest = __temp as mq204script
  MQ204A_008_NoelPackUp.Start()
  Self.SetObjectiveCompleted(50, True)
  Self.SetObjectiveDisplayed(55, True, False)
  Self.SetObjectiveDisplayedAtTop(55)
  Self.SetObjectiveDisplayed(60, True, False)
  Actor CompanionAtLodgeREF = MQ00_CompanionAtLodge.GetActorRef()
  (SQ_Companions as sq_companionsscript).SetRoleInactive(CompanionAtLodgeREF, True, False, True)
  CompanionAtLodgeREF.EvaluatePackage(False)
  Actor VascoREF = Alias_Vasco.GetActorRef()
  (SQ_Followers as sq_followersscript).SetRoleInactive(VascoREF, True, False, True)
  VascoREF.EvaluatePackage(False)
  Actor NoelREF = Alias_Noel.GetActorRef()
  NoelREF.SetGhost(True)
  NoelREF.EvaluatePackage(False)
  Alias_WalterStroud.GetActorRef().EvaluatePackage(False)
  Alias_SamCoe.GetActorRef().EvaluatePackage(False)
  Alias_CoraCoe.GetActorRef().EvaluatePackage(False)
  Alias_SarahMorgan.GetActorRef().EvaluatePackage(False)
  Alias_Barrett.GetActorRef().EvaluatePackage(False)
  Alias_Andreja.GetActorRef().EvaluatePackage(False)
  Alias_MatteoKhatri.GetActorRef().EvaluatePackage(False)
  MQ204_TurnOffCF01Arrest.SetValueInt(1)
EndFunction

Function Fragment_Stage_0080_Item_00()
  MQ204A_008a_NoelPackUp.Stop()
  MQ204A_007_ActivateDoor.Start()
  Alias_LodgeFrontDoor.GetRef().BlockActivation(False, False)
  Alias_LodgeRoofDoor.GetRef().BlockActivation(False, False)
EndFunction

Function Fragment_Stage_0085_Item_00()
  MQ204A_008a_NoelPackUp.Stop()
  Actor WalterREF = Alias_WalterStroud.GetActorRef()
  Actor HunterREF = Alias_TheHunter.GetActorRef()
  WalterREF.SetGhost(True)
  WalterREF.BlockActivation(True, False)
  HunterREF.Disable(False)
  HunterREF.SetGhost(True)
  HunterREF.moveto(MQ204HunterArrivesMarker, 0.0, 0.0, 0.0, True, False)
  HunterREF.EvaluatePackage(False)
  HunterREF.Enable(False)
  HunterREF.AddSpell(MQ204HunterInvisibility, True)
  Self.SetObjectiveDisplayed(55, False, False)
  Self.SetObjectiveDisplayed(80, True, False)
  MUSGenesisStingerDread1Small.Add()
EndFunction

Function Fragment_Stage_0100_Item_00()
  Quest __temp = Self as Quest
  mq204script kmyQuest = __temp as mq204script
  MQ204A_008b_WalterChoking.Stop()
  MUSGenesisStingerDread1Small.Remove()
  MUSGenesisStingerStarbornAppearC.Add()
  Actor HunterREF = Alias_TheHunter.GetActorRef()
  HunterREF.RemoveSpell(MQ204HunterInvisibility)
  WwiseEvent_QST_MQ204_Starborn_VoidForm_End.Play(HunterREF as ObjectReference, None, None)
  Actor WalterREF = Alias_WalterStroud.GetActorRef()
  kmyQuest.SetActorRecovered(WalterREF)
  Actor CompanionLodgeREF = MQ00_CompanionAtLodge.GetActorRef()
  Actor VascoREF = Alias_Vasco.GetActorRef()
  Actor MatteoREF = Alias_MatteoKhatri.GetActorRef()
  WalterREF.SetGroupFaction(MQ204RunningGroupFaction)
  CompanionLodgeREF.SetGroupFaction(MQ204RunningGroupFaction)
  VascoREF.SetGroupFaction(MQ204RunningGroupFaction)
  MatteoREF.SetGroupFaction(MQ204RunningGroupFaction)
  Self.SetObjectiveDisplayed(60, False, False)
  Self.SetObjectiveDisplayed(55, False, False)
  Self.SetObjectiveCompleted(80, True)
  Self.SetObjectiveDisplayed(90, True, False)
  Actor CompanionAtEyeREF = MQ00_CompanionAtEye.GetActorRef()
  MQ00_CompanionWhoDies.ForceRefTo(CompanionAtEyeREF as ObjectReference)
  MQ00_CompanionWhoLives.ForceRefTo(CompanionLodgeREF as ObjectReference)
  kmyQuest.SetDeathFurnitureKeywords(CompanionAtEyeREF, CompanionLodgeREF, MQ204_EyeDeathMarker)
  MQ204EyeCompanionDeadEnableMarker.EnableNoWait(False)
  CompanionAtEyeREF.ChangeAnimFaceArchetype(AnimFaceArchetypeEyesClosed)
  ObjectReference FrontDoorREF = Alias_LodgeFrontDoor.GetRef()
  ObjectReference RoofDoorREF = Alias_LodgeRoofDoor.GetRef()
  ObjectReference FrontDoorExtREF = Alias_LodgeFrontDoorExterior.GetRef()
  ObjectReference RoofDoorExtREF = Alias_LodgeRoofDoorExterior.GetRef()
  FrontDoorREF.BlockActivation(True, False)
  FrontDoorREF.Lock(True, False, True)
  FrontDoorREF.SetLockLevel(254)
  RoofDoorREF.BlockActivation(True, False)
  RoofDoorREF.Lock(True, False, True)
  RoofDoorREF.SetLockLevel(254)
  FrontDoorExtREF.BlockActivation(True, False)
  FrontDoorExtREF.Lock(True, False, True)
  FrontDoorExtREF.SetLockLevel(254)
  RoofDoorExtREF.BlockActivation(True, False)
  RoofDoorExtREF.Lock(True, False, True)
  RoofDoorExtREF.SetLockLevel(254)
  If MQ00_CompanionAtLodge.GetActorRef() != Alias_SamCoe.GetActorRef()
    Self.SetStage(322)
  EndIf
  JemisonGuardShipsEnableMarker.DisableNoWait(False)
  SQ_GuardShips.Stop()
  SQ_GuardShips00.Stop()
  SQ_GuardShips01.Stop()
  MQ204_BarricadeEnableMarker.EnableNoWait(False)
  loadelevatormanagerscript wellElevatorManagerToMAST = Alias_WellElevatorManagerToMAST.GetRef() as loadelevatormanagerscript
  wellElevatorManagerToMAST.SetElevatorOperational(False)
  loadelevatorfloorscript wellElevatorFloorWaterfall = Alias_WellElevatorFloor_Waterfall.GetRef() as loadelevatorfloorscript
  wellElevatorFloorWaterfall.SetAccessible(False)
  Actor SavedCompanionREF = MQ00_CompanionWhoLives.GetActorRef()
  If SavedCompanionREF == Alias_Andreja.GetActorRef()
    MQ_CompanionSaved.SetValueInt(COM_CompanionID_Andreja.GetValueInt())
  ElseIf SavedCompanionREF == Alias_Barrett.GetActorRef()
    MQ_CompanionSaved.SetValueInt(COM_CompanionID_Barrett.GetValueInt())
  ElseIf SavedCompanionREF == Alias_SamCoe.GetActorRef()
    MQ_CompanionSaved.SetValueInt(COM_CompanionID_SamCoe.GetValueInt())
  ElseIf SavedCompanionREF == Alias_SarahMorgan.GetActorRef()
    MQ_CompanionSaved.SetValueInt(COM_CompanionID_SarahMorgan.GetValueInt())
  EndIf
EndFunction

Function Fragment_Stage_0102_Item_00()
  MQ204A_008b_WalterGrabbed.Stop()
  MQ204A_008c_WalterChoking.Stop()
  MQ204A_009_HunterArrives.Start()
EndFunction

Function Fragment_Stage_0105_Item_00()
  Actor TheHunterREF = Alias_TheHunter.GetActorRef()
  Actor PlayerREF = Game.Getplayer()
  Actor WalterREF = Alias_WalterStroud.GetActorRef()
  Game.SetPlayerReportCrime(False)
  WalterREF.SetGhost(False)
  TheHunterREF.AddSpell(abAIPower_MoonForm_Hunter, True)
  TheHunterREF.SetGhost(False)
  TheHunterREF.addtoFaction(PlayerEnemyFaction)
  TheHunterREF.StartCombat(PlayerREF as ObjectReference, False)
  TheHunterREF.EvaluatePackage(False)
  If Self.GetStageDone(100)
    MQ204A_010_ArtifactPackUp.Start()
  EndIf
  PlayerREF.addtoFaction(MQ204UCAllyFaction)
  UC04_Spaceport_WarningSign_EnableMarker.Disable(False)
  MQ204_WellEnableState.DisableNoWait(False)
  WalterREF.BlockActivation(False, False)
  MUSGenesisCombatBoss_MQ204_A_Hunter.Add()
  If CF05.GetStageDone(500) && !CF05.GetStageDone(721)
    CF05.SetStage(703)
  Else
    Alias_SpaceportShip.GetShipRef().EnableNoWait(False)
  EndIf
EndFunction

Function Fragment_Stage_0110_Item_00()
  Actor NoelREF = Alias_Noel.GetActorRef()
  ObjectReference ArmillaryREF = Alias_ArtifactCollectionTrigger.GetRef()
  ArmillaryREF.BlockActivation(True, True)
  (ArmillaryREF as armillaryscript).PackupArmillary(NoelREF)
  Alias_Armillary.GetRef().DisableNoWait(False)
  MQ204SecretDoorREF.BlockActivation(False, False)
  MQ204SecretDoorREF.SetFactionOwner(ConstellationFaction, False)
  MQ204SecretDoorREF.Unlock(False)
EndFunction

Function Fragment_Stage_0115_Item_00()
  MQ204A_011b_EveryoneRuns.Start()
  Self.SetObjectiveCompleted(90, True)
  Self.SetObjectiveDisplayed(100, True, False)
EndFunction

Function Fragment_Stage_0120_Item_00()
  Alias_Noel.GetActorRef().EvaluatePackage(False)
  Alias_TheHunter.GetActorRef().EvaluatePackage(False)
  Self.SetStage(115)
EndFunction

Function Fragment_Stage_0127_Item_00()
  MQ204A_011_NoelRuns.Stop()
  MQ204A_011b_EveryoneRuns.Stop()
  Alias_Noel.GetActorRef().moveto(MQ204_NoelWellEscort_Marker, 0.0, 0.0, 0.0, True, False)
  Alias_WalterStroud.GetActorRef().moveto(MQ204_RunMarker_Walter02, 0.0, 0.0, 0.0, True, False)
  Alias_CompanionAtLodge.GetActorRef().moveto(MQ204_RunMarker_Companion02, 0.0, 0.0, 0.0, True, False)
  Alias_Vasco.GetActorRef().moveto(MQ204_RunMarker_Vasco02, 0.0, 0.0, 0.0, True, False)
  Alias_MatteoKhatri.GetActorRef().moveto(MQ204_RunMarker_Matteo02, 0.0, 0.0, 0.0, True, False)
EndFunction

Function Fragment_Stage_0127_Item_01()
  Alias_CoraCoe.GetActorRef().moveto(MQ204_RunMarker_Cora02, 0.0, 0.0, 0.0, True, False)
EndFunction

Function Fragment_Stage_0130_Item_00()
  Self.SetObjectiveCompleted(100, True)
  Self.SetObjectiveDisplayed(105, True, False)
  Alias_Noel.GetActorRef().EvaluatePackage(False)
  Alias_MatteoKhatri.GetActorRef().EvaluatePackage(False)
  Alias_WalterStroud.GetActorRef().EvaluatePackage(False)
  Alias_Vasco.GetActorRef().EvaluatePackage(False)
  Alias_CompanionAtLodge.GetActorRef().EvaluatePackage(False)
  MQ204A_012b_InCity.Start()
EndFunction

Function Fragment_Stage_0132_Item_00()
  Alias_Noel.GetActorRef().moveto(MQ204NoelRuntoSpaceport, 0.0, 0.0, 0.0, True, False)
  Alias_WalterStroud.GetActorRef().moveto(MQ204_RunMarker_Walter03, 0.0, 0.0, 0.0, True, False)
  Alias_CompanionAtLodge.GetActorRef().moveto(MQ204_RunMarker_Companion03, 0.0, 0.0, 0.0, True, False)
  Alias_Vasco.GetActorRef().moveto(MQ204_RunMarker_Vasco03, 0.0, 0.0, 0.0, True, False)
  Alias_MatteoKhatri.GetActorRef().moveto(MQ204_RunMarker_Matteo03, 0.0, 0.0, 0.0, True, False)
EndFunction

Function Fragment_Stage_0132_Item_01()
  Alias_CoraCoe.GetActorRef().moveto(MQ204_RunMarker_Cora03, 0.0, 0.0, 0.0, True, False)
EndFunction

Function Fragment_Stage_0134_Item_00()
  Alias_Noel.GetActorRef().EvaluatePackage(False)
  Alias_MatteoKhatri.GetActorRef().EvaluatePackage(False)
  Alias_WalterStroud.GetActorRef().EvaluatePackage(False)
  Alias_Vasco.GetActorRef().EvaluatePackage(False)
  Alias_CompanionAtLodge.GetActorRef().EvaluatePackage(False)
  MQ204A_012b_InCity.Stop()
EndFunction

Function Fragment_Stage_0135_Item_00()
  Quest __temp = Self as Quest
  mq204script kmyQuest = __temp as mq204script
  Actor VascoREF = Alias_Vasco.GetActorRef()
  VascoREF.Disable(False)
  Game.Getplayer().addtoFaction(EyeBoardingFaction)
  Actor CompanionAtLodgeREF = MQ00_CompanionAtLodge.GetActorRef()
  ObjectReference PassengerMarkerREF = Alias_PlayerPassengerMarker.GetRef()
  Actor VladimirREF = Alias_Vladimir.GetActorRef()
  Actor WalterREF = Alias_WalterStroud.GetActorRef()
  Actor MatteoREF = Alias_MatteoKhatri.GetActorRef()
  Actor NoelREF = Alias_Noel.GetActorRef()
  kmyQuest.MQ204MoveActor(CompanionAtLodgeREF, PassengerMarkerREF)
  kmyQuest.MQ204MoveActor(WalterREF, PassengerMarkerREF)
  kmyQuest.MQ204MoveActor(MatteoREF, PassengerMarkerREF)
  kmyQuest.MQ204MoveActor(NoelREF, PassengerMarkerREF)
  Self.SetObjectiveCompleted(100, True)
  Self.SetObjectiveCompleted(105, True)
  Self.SetObjectiveDisplayed(110, True, False)
  MQ204A_011b_EveryoneRuns.Stop()
  MQ204A_012c_Spaceport.Stop()
  MQ204A_012c_InShip.Start()
  MQ204LodgeAttackClutterEnableMarker.Enable(False)
  WalterREF.SetGroupFaction(None)
  CompanionAtLodgeREF.SetGroupFaction(None)
  VascoREF.SetGroupFaction(None)
  MatteoREF.SetGroupFaction(None)
  Self.SetStage(136)
  Alias_SpaceportShip.GetRef().DisableNoWait(False)
EndFunction

Function Fragment_Stage_0135_Item_01()
  Quest __temp = Self as Quest
  mq204script kmyQuest = __temp as mq204script
  kmyQuest.MQ204MoveActor(Alias_CoraCoe.GetActorRef(), Alias_PlayerPassengerMarker.GetRef())
EndFunction

Function Fragment_Stage_0136_Item_00()
  Alias_Noel.GetActorRef().EvaluatePackage(False)
EndFunction

Function Fragment_Stage_0140_Item_00()
  MQ204A_012d_InShip.Stop()
  Self.SetObjectiveCompleted(110, True)
  Self.SetObjectiveDisplayed(120, True, False)
EndFunction

Function Fragment_Stage_0145_Item_00()
  Quest __temp = Self as Quest
  mq204script kmyQuest = __temp as mq204script
  Actor AndrejaREF = Alias_Andreja.GetActorRef()
  Actor BarrettREF = Alias_Barrett.GetActorRef()
  Actor SamCoeREF = Alias_SamCoe.GetActorRef()
  Actor CoraCoeREF = Alias_CoraCoe.GetActorRef()
  Actor SarahMorganREF = Alias_SarahMorgan.GetActorRef()
  Actor VladimirREF = Alias_Vladimir.GetActorRef()
  Actor WalterREF = Alias_WalterStroud.GetActorRef()
  Actor MatteoREF = Alias_MatteoKhatri.GetActorRef()
  Actor VascoREF = Alias_Vasco.GetActorRef()
  Actor NoelREF = Alias_Noel.GetActorRef()
  Actor CompanionWhoLivesREF = MQ00_CompanionWhoLives.GetActorRef()
  Actor CompanionWhoDiesREF = MQ00_CompanionWhoDies.GetActorRef()
  Actor CompanionAtLodgeREF = MQ00_CompanionAtLodge.GetActorRef()
  kmyQuest.MQ204MoveActor(VladimirREF, EyeMarker)
  If CompanionAtLodgeREF != AndrejaREF
    kmyQuest.MQ204MoveActor(AndrejaREF, EyeMarker)
  EndIf
  If CompanionAtLodgeREF != SarahMorganREF
    kmyQuest.MQ204MoveActor(SarahMorganREF, EyeMarker)
  EndIf
  If CompanionAtLodgeREF != BarrettREF
    kmyQuest.MQ204MoveActor(BarrettREF, EyeMarker)
  EndIf
  If CompanionAtLodgeREF != SamCoeREF
    kmyQuest.MQ204MoveActor(SamCoeREF, EyeMarker)
  EndIf
  CompanionAtLodgeREF.moveto(EyeMarker, 0.0, 0.0, 0.0, True, False)
  CompanionWhoLivesREF.BlockActivation(True, True)
  CompanionWhoLivesREF.SetGhost(True)
  CompanionWhoDiesREF.SetGhost(True)
  kmyQuest.SetActorHunterAttacked(VladimirREF, True)
  If CompanionWhoDiesREF == AndrejaREF || CompanionWhoLivesREF == AndrejaREF
    
  Else
    kmyQuest.SetActorHunterAttacked(AndrejaREF, True)
  EndIf
  If CompanionWhoDiesREF == BarrettREF || CompanionWhoLivesREF == BarrettREF
    
  Else
    kmyQuest.SetActorHunterAttacked(BarrettREF, True)
  EndIf
  If CompanionWhoDiesREF == SamCoeREF || CompanionWhoLivesREF == SamCoeREF
    
  Else
    kmyQuest.SetActorHunterAttacked(SamCoeREF, True)
  EndIf
  If CompanionWhoDiesREF == SarahMorganREF || CompanionWhoLivesREF == SarahMorganREF
    
  Else
    kmyQuest.SetActorHunterAttacked(SarahMorganREF, True)
  EndIf
  Self.SetStage(140)
EndFunction

Function Fragment_Stage_0150_Item_00()
  MQ204A_013_HunterScene01.Start()
EndFunction

Function Fragment_Stage_0152_Item_00()
  Actor HunterREF = Alias_TheHunter.GetActorRef()
  Actor PlayerREF = Game.Getplayer()
  HunterREF.EvaluatePackage(False)
  HunterREF.StartCombat(PlayerREF as ObjectReference, True)
EndFunction

Function Fragment_Stage_0153_Item_00()
  MQ204A_013_HunterScene01.Stop()
  MQ204A_013_HunterScene01b.Start()
EndFunction

Function Fragment_Stage_0154_Item_00()
  Actor HunterREF = Alias_TheHunter.GetActorRef()
  Actor PlayerREF = Game.Getplayer()
  HunterREF.EvaluatePackage(False)
  HunterREF.StartCombat(PlayerREF as ObjectReference, True)
EndFunction

Function Fragment_Stage_0155_Item_00()
  MQ204A_013_HunterScene01.Stop()
  MQ204A_013_HunterScene01b.Stop()
  MQ204A_013_HunterScene02.Start()
EndFunction

Function Fragment_Stage_0157_Item_00()
  Actor HunterREF = Alias_TheHunter.GetActorRef()
  Actor PlayerREF = Game.Getplayer()
  HunterREF.EvaluatePackage(False)
  HunterREF.StartCombat(PlayerREF as ObjectReference, True)
EndFunction

Function Fragment_Stage_0170_Item_00()
  Self.SetObjectiveCompleted(120, True)
  Self.SetObjectiveDisplayed(140, True, False)
  Actor VladimirREF = Alias_Vladimir.GetActorRef()
  VladimirREF.EvaluatePackage(False)
  Alias_Noel.GetActorRef().moveto(MQ204_Stage200EyeMarker_Noel, 0.0, 0.0, 0.0, True, False)
EndFunction

Function Fragment_Stage_0200_Item_00()
  MQ204A_016_ReturnScene.Start()
  Self.SetObjectiveCompleted(140, True)
  Self.SetObjectiveDisplayed(150, True, False)
EndFunction

Function Fragment_Stage_0300_Item_00()
  Actor AndrejaREF = Alias_Andreja.GetActorRef()
  Actor BarrettREF = Alias_Barrett.GetActorRef()
  Actor SamCoeREF = Alias_SamCoe.GetActorRef()
  Actor SarahMorganREF = Alias_SarahMorgan.GetActorRef()
  Actor DeadCompanionREF = MQ00_CompanionWhoDies.GetActorRef()
  DeadCompanionREF.BlockActivation(True, True)
  DeadCompanionREF.SetUnconscious(True)
  DeadCompanionREF.SetValue(COM_IsRomantic, 0.0)
  DeadCompanionREF.SetValue(COM_IsCommitted, 0.0)
  Game.RemoveFromAvailableCrew(DeadCompanionREF)
  If DeadCompanionREF == AndrejaREF
    MQ_CompanionDead.SetValueInt(COM_CompanionID_Andreja.GetValueInt())
    If COM_Quest_Andreja_Q01.IsRunning()
      COM_Quest_Andreja_Q01.SetStage(20000)
    EndIf
    If COM_Companion_Andreja.IsObjectiveDisplayed(10)
      COM_Companion_Andreja.SetObjectiveDisplayed(10, False, False)
    EndIf
  ElseIf DeadCompanionREF == BarrettREF
    MQ_CompanionDead.SetValueInt(COM_CompanionID_Barrett.GetValueInt())
    If COM_Quest_Barrett_Q01.IsRunning()
      COM_Quest_Barrett_Q01.SetStage(20000)
    EndIf
    If COM_Quest_Barrett_Q02.IsRunning()
      COM_Quest_Barrett_Q02.SetStage(20000)
    EndIf
    If Com_Companion_Barrett.IsObjectiveDisplayed(900)
      Com_Companion_Barrett.SetObjectiveDisplayed(900, False, False)
    EndIf
  ElseIf DeadCompanionREF == SamCoeREF
    MQ_CompanionDead.SetValueInt(COM_CompanionID_SamCoe.GetValueInt())
    If COM_Quest_SamCoe_Q01.IsRunning()
      COM_Quest_SamCoe_Q01.SetStage(20000)
    EndIf
    If COM_Companion_SamCoe.IsObjectiveDisplayed(10)
      COM_Companion_SamCoe.SetObjectiveDisplayed(10, False, False)
    EndIf
    If COM_Companion_SamCoe.IsObjectiveDisplayed(798)
      COM_Companion_SamCoe.SetObjectiveDisplayed(798, False, False)
    EndIf
    If COM_Companion_SamCoe.IsObjectiveDisplayed(801)
      COM_Companion_SamCoe.SetObjectiveDisplayed(801, False, False)
    EndIf
    If COM_Companion_SamCoe.IsObjectiveDisplayed(802)
      COM_Companion_SamCoe.SetObjectiveDisplayed(802, False, False)
    EndIf
  ElseIf DeadCompanionREF == SarahMorganREF
    MQ_CompanionDead.SetValueInt(COM_CompanionID_SarahMorgan.GetValueInt())
    If COM_Quest_SarahMorgan_Q01.IsRunning()
      COM_Quest_SarahMorgan_Q01.SetStage(20000)
    EndIf
    If COM_Companion_SarahMorgan.IsObjectiveDisplayed(10)
      COM_Companion_SarahMorgan.SetObjectiveDisplayed(10, False, False)
    EndIf
  EndIf
  Actor CompanionWhoLivesREF = MQ00_CompanionWhoLives.GetActorRef()
  (SQ_Companions as sq_companionsscript).SetRoleActive(CompanionWhoLivesREF, True, True, 0.0, 0.0)
  (SQ_Companions as sq_companionsscript).LockInCompanion(CompanionWhoLivesREF as companionactorscript, True, MQ204CompanionLockInMSG, None)
  CompanionWhoLivesREF.EvaluatePackage(False)
  CompanionWhoLivesREF.BlockActivation(False, False)
  CompanionWhoLivesREF.SetGhost(False)
  If AndrejaREF != DeadCompanionREF
    AndrejaREF.SetValue(CrewReassignDisabled, 0.0)
  EndIf
  If BarrettREF != DeadCompanionREF
    BarrettREF.SetValue(CrewReassignDisabled, 0.0)
  EndIf
  If SamCoeREF != DeadCompanionREF
    SamCoeREF.SetValue(CrewReassignDisabled, 0.0)
  EndIf
  If SarahMorganREF != DeadCompanionREF
    SarahMorganREF.SetValue(CrewReassignDisabled, 0.0)
  EndIf
EndFunction

Function Fragment_Stage_0305_Item_00()
  Quest __temp = Self as Quest
  mq204script kmyQuest = __temp as mq204script
  Actor VladimirREF = Alias_Vladimir.GetActorRef()
  VladimirREF.SetActivateTextOverride(None)
  VladimirREF.EvaluatePackage(False)
  kmyQuest.CheckEyeActors()
EndFunction

Function Fragment_Stage_0310_Item_00()
  Quest __temp = Self as Quest
  mq204script kmyQuest = __temp as mq204script
  Actor DeadCompanionREF = MQ00_CompanionWhoDies.GetActorRef()
  Actor LivesCompanionREF = MQ00_CompanionWhoLives.GetActorRef()
  Actor AndrejaREF = Alias_Andreja.GetActorRef()
  If DeadCompanionREF == AndrejaREF
    Self.SetStage(300)
  ElseIf LivesCompanionREF == AndrejaREF
    Self.SetStage(440)
  EndIf
  kmyQuest.RescuedActor(AndrejaREF)
EndFunction

Function Fragment_Stage_0320_Item_00()
  Quest __temp = Self as Quest
  mq204script kmyQuest = __temp as mq204script
  Actor DeadCompanionREF = MQ00_CompanionWhoDies.GetActorRef()
  Actor LivesCompanionREF = MQ00_CompanionWhoLives.GetActorRef()
  Actor BarrettREF = Alias_Barrett.GetActorRef()
  If DeadCompanionREF == BarrettREF
    Self.SetStage(300)
  ElseIf LivesCompanionREF == BarrettREF
    Self.SetStage(440)
  EndIf
  kmyQuest.RescuedActor(BarrettREF)
EndFunction

Function Fragment_Stage_0322_Item_00()
  Actor SamCoeREF = Alias_SamCoe.GetActorRef()
  If MQ00_CompanionWhoDies.GetActorRef() == SamCoeREF
    Self.SetStage(324)
  EndIf
EndFunction

Function Fragment_Stage_0325_Item_00()
  Actor SamCoeREF = Alias_SamCoe.GetActorRef()
  If MQ00_CompanionWhoDies.GetActorRef() == SamCoeREF
    MQ204A_030a_DeathCoraScene.Start()
  ElseIf Alias_Companion.GetActorRef() != SamCoeREF
    MQ204A_020a_MedstimSam.Start()
  EndIf
EndFunction

Function Fragment_Stage_0330_Item_00()
  Quest __temp = Self as Quest
  mq204script kmyQuest = __temp as mq204script
  Actor DeadCompanionREF = MQ00_CompanionWhoDies.GetActorRef()
  Actor LivesCompanionREF = MQ00_CompanionWhoLives.GetActorRef()
  Actor SamCoeREF = Alias_SamCoe.GetActorRef()
  Actor CoraREF = Alias_CoraCoe.GetActorRef()
  If DeadCompanionREF == SamCoeREF
    Game.Getplayer().SetValue(MQ204SamDied, 1.0)
    Self.SetStage(300)
  ElseIf LivesCompanionREF == SamCoeREF
    Self.SetStage(440)
  EndIf
  kmyQuest.RescuedActor(SamCoeREF)
  CoraREF.SetGhost(False)
  CoraREF.SetActivateTextOverride(None)
EndFunction

Function Fragment_Stage_0340_Item_00()
  Quest __temp = Self as Quest
  mq204script kmyQuest = __temp as mq204script
  Actor DeadCompanionREF = MQ00_CompanionWhoDies.GetActorRef()
  Actor LivesCompanionREF = MQ00_CompanionWhoLives.GetActorRef()
  Actor SarahMorganREF = Alias_SarahMorgan.GetActorRef()
  If DeadCompanionREF == SarahMorganREF
    Self.SetStage(300)
  ElseIf LivesCompanionREF == SarahMorganREF
    Self.SetStage(440)
  EndIf
  kmyQuest.RescuedActor(SarahMorganREF)
EndFunction

Function Fragment_Stage_0350_Item_00()
  Quest __temp = Self as Quest
  mq204script kmyQuest = __temp as mq204script
  Actor MatteoREF = Alias_MatteoKhatri.GetActorRef()
  MatteoREF.SetActivateTextOverride(None)
  MatteoREF.SetGhost(False)
  kmyQuest.CheckLodgeActors()
EndFunction

Function Fragment_Stage_0360_Item_00()
  Quest __temp = Self as Quest
  mq204script kmyQuest = __temp as mq204script
  Actor WalterREF = Alias_WalterStroud.GetActorRef()
  WalterREF.SetActivateTextOverride(None)
  WalterREF.SetGhost(False)
  kmyQuest.CheckLodgeActors()
EndFunction

Function Fragment_Stage_0370_Item_00()
  Quest __temp = Self as Quest
  mq204script kmyQuest = __temp as mq204script
  Actor VascoREF = Alias_Vasco.GetActorRef()
  kmyQuest.SetActorRecovered(VascoREF)
  VascoREF.SetActivateTextOverride(None)
  VascoREF.SetGhost(False)
  kmyQuest.CheckLodgeActors()
EndFunction

Function Fragment_Stage_0390_Item_00()
  If Self.GetStageDone(100)
    Self.SetStage(170)
  EndIf
  If Self.GetStageDone(400)
    Self.SetStage(450)
  EndIf
  Alias_Vladimir.GetActorRef().EvaluatePackage(False)
EndFunction

Function Fragment_Stage_0400_Item_00()
  Quest __temp = Self as Quest
  mq204script kmyQuest = __temp as mq204script
  kmyQuest.MQ204EnableLayer = None
  Game.Getplayer().addtoFaction(EyeBoardingFaction)
  Self.SetObjectiveDisplayed(55, False, False)
  Self.SetObjectiveDisplayed(80, False, False)
  Self.SetObjectiveDisplayed(60, True, True)
  ObjectReference FrontDoorREF = Alias_LodgeFrontDoor.GetRef()
  ObjectReference RoofDoorREF = Alias_LodgeRoofDoor.GetRef()
  ObjectReference FrontDoorExtREF = Alias_LodgeFrontDoorExterior.GetRef()
  ObjectReference RoofDoorExtREF = Alias_LodgeRoofDoorExterior.GetRef()
  FrontDoorREF.BlockActivation(True, False)
  FrontDoorREF.Lock(True, False, True)
  FrontDoorREF.SetLockLevel(254)
  RoofDoorREF.BlockActivation(True, False)
  RoofDoorREF.Lock(True, False, True)
  RoofDoorREF.SetLockLevel(254)
  FrontDoorExtREF.BlockActivation(True, False)
  FrontDoorExtREF.Lock(True, False, True)
  FrontDoorExtREF.SetLockLevel(254)
  RoofDoorExtREF.BlockActivation(True, False)
  RoofDoorExtREF.Lock(True, False, True)
  RoofDoorExtREF.SetLockLevel(254)
  MQ204A_007_ActivateDoor.Stop()
  Actor CompanionAtLodgeREF = MQ00_CompanionAtLodge.GetActorRef()
  Actor CompanionAtEyeREF = MQ00_CompanionAtEye.GetActorRef()
  MQ00_CompanionWhoDies.ForceRefTo(CompanionAtLodgeREF as ObjectReference)
  MQ00_CompanionWhoLives.ForceRefTo(CompanionAtEyeREF as ObjectReference)
  MQ204LodgeCompanionDeadEnableMarker.EnableNoWait(False)
  kmyQuest.SetDeathFurnitureKeywords(CompanionAtLodgeREF, CompanionAtEyeREF, MQ204LodgeDeathMarker)
  CompanionAtLodgeREF.ChangeAnimFaceArchetype(AnimFaceArchetypeEyesClosed)
  Alias_TheHunter.GetActorRef().moveto(MQHoldingCellCenterMarker, 0.0, 0.0, 0.0, True, False)
  If MQ00_CompanionAtLodge.GetActorRef() == Alias_SamCoe.GetActorRef()
    Self.SetStage(323)
  EndIf
  If MQ00_CompanionAtLodge.GetActorRef() != Alias_SamCoe.GetActorRef()
    Self.SetStage(322)
  EndIf
  MQ204LodgeAttackClutterEnableMarker.Enable(False)
  Actor SavedCompanionREF = MQ00_CompanionWhoLives.GetActorRef()
  If SavedCompanionREF == Alias_Andreja.GetActorRef()
    MQ_CompanionSaved.SetValueInt(COM_CompanionID_Andreja.GetValueInt())
  ElseIf SavedCompanionREF == Alias_Barrett.GetActorRef()
    MQ_CompanionSaved.SetValueInt(COM_CompanionID_Barrett.GetValueInt())
  ElseIf SavedCompanionREF == Alias_SamCoe.GetActorRef()
    MQ_CompanionSaved.SetValueInt(COM_CompanionID_SamCoe.GetValueInt())
  ElseIf SavedCompanionREF == Alias_SarahMorgan.GetActorRef()
    MQ_CompanionSaved.SetValueInt(COM_CompanionID_SarahMorgan.GetValueInt())
  EndIf
  MQ204A_004_NoelAmbient.Stop()
  MQ204A_008b_WalterGrabbed.Stop()
EndFunction

Function Fragment_Stage_0420_Item_00()
  Quest __temp = Self as Quest
  mq204script kmyQuest = __temp as mq204script
  Self.SetObjectiveCompleted(60, True)
  Self.SetObjectiveDisplayed(120, True, False)
EndFunction

Function Fragment_Stage_0425_Item_00()
  Quest __temp = Self as Quest
  mq204script kmyQuest = __temp as mq204script
  Actor AndrejaREF = Alias_Andreja.GetActorRef()
  Actor BarrettREF = Alias_Barrett.GetActorRef()
  Actor SamCoeREF = Alias_SamCoe.GetActorRef()
  Actor CoraCoeREF = Alias_CoraCoe.GetActorRef()
  Actor SarahMorganREF = Alias_SarahMorgan.GetActorRef()
  Actor VladimirREF = Alias_Vladimir.GetActorRef()
  Actor WalterREF = Alias_WalterStroud.GetActorRef()
  Actor MatteoREF = Alias_MatteoKhatri.GetActorRef()
  Actor VascoREF = Alias_Vasco.GetActorRef()
  Actor NoelREF = Alias_Noel.GetActorRef()
  Actor CompanionAtLodgeREF = MQ00_CompanionAtLodge.GetActorRef()
  If CompanionAtLodgeREF == AndrejaREF
    
  Else
    kmyQuest.MQ204MoveActor(AndrejaREF, EyeMarker)
  EndIf
  If CompanionAtLodgeREF == BarrettREF
    
  Else
    kmyQuest.MQ204MoveActor(BarrettREF, EyeMarker)
  EndIf
  If CompanionAtLodgeREF == SamCoeREF
    
  Else
    kmyQuest.MQ204MoveActor(SamCoeREF, EyeMarker)
    kmyQuest.MQ204MoveActor(CoraCoeREF, EyeMarker)
  EndIf
  If CompanionAtLodgeREF == SarahMorganREF
    
  Else
    kmyQuest.MQ204MoveActor(SarahMorganREF, EyeMarker)
  EndIf
  kmyQuest.MQ204MoveActor(VladimirREF, EyeMarker)
  Self.SetStage(420)
EndFunction

Function Fragment_Stage_0440_Item_00()
  Actor CompanionWhoLivesREF = MQ00_CompanionWhoLives.GetActorRef()
  CompanionWhoLivesREF.EvaluatePackage(False)
  Alias_CoraCoe.GetActorRef().EvaluatePackage(False)
EndFunction

Function Fragment_Stage_0450_Item_00()
  Quest __temp = Self as Quest
  mq204script kmyQuest = __temp as mq204script
  Self.SetObjectiveCompleted(120, True)
  Self.SetObjectiveDisplayed(300, True, False)
  Actor NoelREF = Alias_Noel.GetActorRef()
  NoelREF.Disable(False)
  NoelREF.moveto(MQ204_NoelHidingMarker, 0.0, 0.0, 0.0, True, False)
  NoelREF.EvaluatePackage(False)
  NoelREF.Enable(False)
  ObjectReference ArmillaryREF = Alias_ArtifactCollectionTrigger.GetRef()
  (ArmillaryREF as armillaryscript).PackupArmillary(NoelREF)
  Alias_Armillary.GetRef().DisableNoWait(False)
  ArmillaryREF.BlockActivation(True, True)
  ObjectReference FrontDoorREF = Alias_LodgeFrontDoor.GetRef()
  ObjectReference RoofDoorREF = Alias_LodgeRoofDoor.GetRef()
  ObjectReference FrontDoorExtREF = Alias_LodgeFrontDoorExterior.GetRef()
  ObjectReference RoofDoorExtREF = Alias_LodgeRoofDoorExterior.GetRef()
  FrontDoorREF.BlockActivation(False, False)
  FrontDoorREF.Lock(False, False, True)
  FrontDoorREF.SetLockLevel(0)
  RoofDoorREF.BlockActivation(False, False)
  RoofDoorREF.Lock(False, False, True)
  RoofDoorREF.SetLockLevel(0)
  FrontDoorExtREF.BlockActivation(False, False)
  FrontDoorExtREF.Lock(False, False, True)
  FrontDoorExtREF.SetLockLevel(0)
  RoofDoorExtREF.BlockActivation(False, False)
  RoofDoorExtREF.Lock(False, False, True)
  RoofDoorExtREF.SetLockLevel(0)
EndFunction

Function Fragment_Stage_0455_Item_00()
  Quest __temp = Self as Quest
  mq204script kmyQuest = __temp as mq204script
  Actor CompanionAtEyeREF = MQ00_CompanionAtEye.GetActorRef()
  Actor CoraCoeREF = Alias_CoraCoe.GetActorRef()
  Actor SamCoeREF = Alias_SamCoe.GetActorRef()
  ObjectReference PassengerMarkerREF = Alias_PlayerPassengerMarker.GetRef()
  kmyQuest.MQ204MoveActor(CompanionAtEyeREF, PassengerMarkerREF)
  If CompanionAtEyeREF == SamCoeREF
    kmyQuest.MQ204MoveActor(CoraCoeREF, PassengerMarkerREF)
  EndIf
EndFunction

Function Fragment_Stage_0460_Item_00()
  Quest __temp = Self as Quest
  mq204script kmyQuest = __temp as mq204script
  Actor AndrejaREF = Alias_Andreja.GetActorRef()
  Actor BarrettREF = Alias_Barrett.GetActorRef()
  Actor SamCoeREF = Alias_SamCoe.GetActorRef()
  Actor CoraCoeREF = Alias_CoraCoe.GetActorRef()
  Actor SarahMorganREF = Alias_SarahMorgan.GetActorRef()
  Actor VladimirREF = Alias_Vladimir.GetActorRef()
  Actor WalterREF = Alias_WalterStroud.GetActorRef()
  Actor MatteoREF = Alias_MatteoKhatri.GetActorRef()
  Actor VascoREF = Alias_Vasco.GetActorRef()
  Actor NoelREF = Alias_Noel.GetActorRef()
  Actor CompanionWhoLivesREF = MQ00_CompanionWhoLives.GetActorRef()
  Actor CompanionWhoDiesREF = MQ00_CompanionWhoDies.GetActorRef()
  kmyQuest.MQ204EnableLayer = inputenablelayer.Create()
  kmyQuest.MQ204EnableLayer.EnableFastTravel(False)
  kmyQuest.MQ204EnableLayer.EnableGravJump(False)
  Self.SetObjectiveCompleted(300, True)
  Self.SetObjectiveDisplayed(310, True, False)
  MQ204_BarricadeEnableMarker.Enable(False)
  loadelevatormanagerscript wellElevatorManagerToMAST = Alias_WellElevatorManagerToMAST.GetRef() as loadelevatormanagerscript
  wellElevatorManagerToMAST.SetElevatorOperational(False)
  loadelevatorfloorscript wellElevatorFloorWaterfall = Alias_WellElevatorFloor_Waterfall.GetRef() as loadelevatorfloorscript
  wellElevatorFloorWaterfall.SetAccessible(False)
  CompanionWhoLivesREF.EvaluatePackage(False)
  CompanionWhoLivesREF.BlockActivation(True, True)
  CompanionWhoLivesREF.SetGhost(True)
  CompanionWhoDiesREF.SetGhost(True)
  CompanionWhoLivesREF.moveto(LodgeStartMarker, 0.0, 0.0, 0.0, True, False)
  kmyQuest.MQ204MoveActor(CompanionWhoDiesREF, MQ204LodgeDeathNearMarker)
  If CompanionWhoDiesREF == SamCoeREF
    kmyQuest.MQ204MoveActor(CoraCoeREF, LodgeStartMarker)
  EndIf
  kmyQuest.MQ204MoveActor(WalterREF, LodgeStartMarker)
  kmyQuest.MQ204MoveActor(MatteoREF, LodgeStartMarker)
  kmyQuest.MQ204MoveActor(VascoREF, LodgeStartMarker)
  kmyQuest.SetActorInBleedOut(VascoREF)
  kmyQuest.SetActorHunterAttacked(MatteoREF, True)
  kmyQuest.SetActorHunterAttacked(VascoREF, True)
  kmyQuest.SetActorHunterAttacked(WalterREF, True)
  WalterREF.SetGhost(False)
  WalterREF.BlockActivation(False, False)
EndFunction

Function Fragment_Stage_0470_Item_00()
  Self.SetObjectiveCompleted(310, True)
  Self.SetObjectiveDisplayed(320, True, False)
  MQ204SecretDoorREF.BlockActivation(False, False)
  MQ204SecretDoorREF.SetFactionOwner(ConstellationFaction, False)
  MQ204SecretDoorREF.Unlock(False)
EndFunction

Function Fragment_Stage_0480_Item_00()
  Quest __temp = Self as Quest
  mq204script kmyQuest = __temp as mq204script
  Game.StopDialogueCamera(False, False)
  kmyQuest.MQ204EnableLayer.EnableFastTravel(False)
  kmyQuest.MQ204EnableLayer.EnableGravJump(False)
  kmyQuest.MQ204EnableLayer.EnableFarTravel(False)
  MQ204DoortoLodgeREF.BlockActivation(True, False)
  MQ204DoortoLodgeREF.Lock(True, False, True)
  MQ204DoortoLodgeREF.SetLockLevel(254)
  JemisonGuardShipsEnableMarker.DisableNoWait(False)
  SQ_GuardShips.Stop()
  SQ_GuardShips00.Stop()
  SQ_GuardShips01.Stop()
  Actor NoelREF = Alias_Noel.GetActorRef()
  NoelREF.SetGhost(True)
  Self.SetStage(105)
  Self.SetStage(310)
  Self.SetStage(320)
  Self.SetStage(330)
  Self.SetStage(340)
  Self.SetStage(470)
  Self.SetObjectiveCompleted(320, True)
  Self.SetObjectiveDisplayed(330, True, False)
EndFunction

Function Fragment_Stage_0485_Item_00()
  Actor HunterREF = Alias_TheHunter.GetActorRef()
  HunterREF.RemoveSpell(MQ204HunterInvisibility)
EndFunction

Function Fragment_Stage_0487_Item_00()
  Alias_Noel.GetActorRef().moveto(MQ204NoelRuntoSpaceport, 0.0, 0.0, 0.0, True, False)
EndFunction

Function Fragment_Stage_0488_Item_00()
  Alias_Noel.GetActorRef().EvaluatePackage(False)
EndFunction

Function Fragment_Stage_0490_Item_00()
  MQ204A_037_PlayerInShip.Start()
  Self.SetObjectiveCompleted(330, True)
  Self.SetObjectiveDisplayed(340, True, False)
  Alias_SpaceportShip.GetRef().DisableNoWait(False)
EndFunction

Function Fragment_Stage_0490_Item_01()
  Alias_CoraCoe.GetActorRef().moveto(Alias_PlayerPassengerMarker.GetRef(), 0.0, 0.0, 0.0, True, False)
EndFunction

Function Fragment_Stage_0492_Item_00()
  Self.SetObjectiveCompleted(340, True)
  Self.SetObjectiveDisplayed(350, True, False)
EndFunction

Function Fragment_Stage_0495_Item_00()
  Quest __temp = Self as Quest
  mq204script kmyQuest = __temp as mq204script
  Actor NoelREF = Alias_Noel.GetActorRef()
  kmyQuest.MQ204MoveActor(NoelREF, EyeMarker)
  Alias_Vladimir.GetActorRef().EvaluatePackage(False)
  Self.SetObjectiveCompleted(350, True)
  Self.SetObjectiveDisplayed(360, True, False)
EndFunction

Function Fragment_Stage_0510_Item_00()
  Quest __temp = Self as Quest
  mq204script kmyQuest = __temp as mq204script
  MQAlllowArmillaryGravDrive.SetValueInt(1)
  Alias_HomeShipArmillaryScreenTrigger.GetRef().Enable(False)
  Self.SetObjectiveCompleted(150, True)
  Self.SetObjectiveCompleted(360, True)
  Self.SetObjectiveDisplayed(500, True, False)
  Self.SetObjectiveDisplayedAtTop(500)
  Self.SetObjectiveDisplayed(510, True, False)
  kmyQuest.PlayerReceivesArtifacts()
  Game.Getplayer().additem(Mfg_Tier01_Structural_Frame as Form, 2, False)
  Actor VascoREF = Alias_Vasco.GetActorRef()
  If VascoREF.IsDisabled()
    VascoREF.EvaluatePackage(False)
    VascoREF.moveto(LodgeStartMarker, 0.0, 0.0, 0.0, True, False)
    VascoREF.Enable(False)
  EndIf
  MQ204ArmillaryBuildMSG.Show(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)
EndFunction

Function Fragment_Stage_0600_Item_00()
  Quest __temp = Self as Quest
  mq204script kmyQuest = __temp as mq204script
  Game.SetInChargen(True, False, False)
  kmyQuest.MQ204EnableLayer.DisablePlayerControls(True, True, False, False, False, True, True, False, True, True, False)
  spaceshipreference ScorpiusREF = Alias_TheScorpius.GetShipReference()
  spaceshipreference PlayerShipREF = Alias_PlayerShip.GetShipReference()
  ScorpiusREF.SetGhost(True)
  ScorpiusREF.MoveNear(PlayerShipREF as ObjectReference, 1, 0, 0)
  ScorpiusREF.EnableWithGravJump()
  MQ204A_052_ScorpiusScene.Start()
  MUSGenesisStingerStarbornAppearC.Add()
EndFunction

Function Fragment_Stage_0610_Item_00()
  Quest __temp = Self as Quest
  mq204script kmyQuest = __temp as mq204script
  Actor PlayerREF = Game.Getplayer()
  Actor TheHunterREF = Alias_TheHunter.GetActorRef()
  MUSGenesisStingerStarbornAppearC.Remove()
  MUSGenesisCombatBoss_MQ204_A_Hunter.Remove()
  PlayerREF.RemoveFromFaction(MQ204UCAllyFaction)
  Game.SetPlayerReportCrime(True)
  TheHunterREF.RemoveFromFaction(PlayerEnemyFaction)
  PlayerREF.StopCombatAlarm()
  TheHunterREF.Disable(False)
  MQ204_BarricadeEnableMarker.DisableNoWait(False)
  loadelevatormanagerscript wellElevatorManagerToMAST = Alias_WellElevatorManagerToMAST.GetRef() as loadelevatormanagerscript
  wellElevatorManagerToMAST.SetElevatorOperational(True)
  loadelevatorfloorscript wellElevatorFloorWaterfall = Alias_WellElevatorFloor_Waterfall.GetRef() as loadelevatorfloorscript
  wellElevatorFloorWaterfall.SetAccessible(True)
  spaceshipreference ScorpiusREF = Alias_TheScorpius.GetShipReference()
  ScorpiusREF.SetGhost(False)
  ScorpiusREF.DisableWithGravJumpNoWait()
  Game.SetInChargen(False, False, False)
  kmyQuest.MQ204EnableLayer.EnableFastTravel(True)
  kmyQuest.MQ204EnableLayer.EnableGravJump(True)
  kmyQuest.MQ204EnableLayer.EnableFarTravel(True)
  kmyQuest.MQ204EnableLayer = None
  NewAtlantisMapMarkerLodge.DisableNoWait(False)
  NewAtlantisMapMarkerCommercialDistrict.DisableNoWait(False)
  NewAtlantisMapMarkerWestEnd.DisableNoWait(False)
  NewAtlantisMapMarkerEmbassy.DisableNoWait(False)
  NewAtlantisMapMarkerResidentialDistrict.DisableNoWait(False)
  ObjectReference FrontDoorREF = Alias_LodgeFrontDoor.GetRef()
  ObjectReference RoofDoorREF = Alias_LodgeRoofDoor.GetRef()
  ObjectReference FrontDoorExtREF = Alias_LodgeFrontDoorExterior.GetRef()
  ObjectReference RoofDoorExtREF = Alias_LodgeRoofDoorExterior.GetRef()
  FrontDoorREF.BlockActivation(False, False)
  FrontDoorREF.Lock(False, False, True)
  FrontDoorREF.SetLockLevel(0)
  RoofDoorREF.BlockActivation(False, False)
  RoofDoorREF.Lock(False, False, True)
  RoofDoorREF.SetLockLevel(0)
  FrontDoorExtREF.BlockActivation(False, False)
  FrontDoorExtREF.Lock(False, False, True)
  FrontDoorExtREF.SetLockLevel(0)
  RoofDoorExtREF.BlockActivation(False, False)
  RoofDoorExtREF.Lock(False, False, True)
  RoofDoorExtREF.SetLockLevel(0)
  MQ204DoortoLodgeREF.BlockActivation(False, False)
  MQ204DoortoLodgeREF.Lock(False, False, True)
  MQ204DoortoLodgeREF.SetLockLevel(0)
  If Self.GetStageDone(480)
    Self.SetStage(492)
  EndIf
  MQ204xPostQuest.Start()
  CityNewAtlantisLocation.Reset()
  CityNewAtlantisWellLocation.Reset()
  Actor NoelREF = Alias_Noel.GetActorRef()
  NoelREF.SetGhost(False)
  MQ204_NA_StateChangeHandler.SetStageNoWait(10)
  MQ204_TurnOffCF01Arrest.SetValueInt(0)
  JemisonGuardShipsEnableMarker.EnableNoWait(False)
  NewAtlantisMapMarkerLodge.EnableFastTravel(True)
  NewAtlantisMapMarkerCommercialDistrict.EnableFastTravel(True)
  NewAtlantisMapMarkerWestEnd.EnableFastTravel(True)
  NewAtlantisMapMarkerEmbassy.EnableFastTravel(True)
  NewAtlantisMapMarkerResidentialDistrict.EnableFastTravel(True)
  NewAtlantisMapMarkerSpaceport.EnableFastTravel(True)
EndFunction

Function Fragment_Stage_0620_Item_00()
  Quest __temp = Self as Quest
  mq204script kmyQuest = __temp as mq204script
  Self.SetObjectiveCompleted(500, True)
  Self.SetObjectiveCompleted(510, True)
  Self.SetObjectiveDisplayed(520, True, False)
  Actor DeadCompanionREF = MQ00_CompanionWhoDies.GetActorRef()
  DeadCompanionREF.KillEssential(None)
  DeadCompanionREF.Disable(False)
  MQ204EyeCompanionDeadEnableMarker.DisableNoWait(False)
  MQ204LodgeCompanionDeadEnableMarker.DisableNoWait(False)
  MQ204ArmillaryAttackMSG.Show(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)
  MQ204_TurnOffCF01Arrest.SetValueInt(0)
EndFunction

Function Fragment_Stage_0650_Item_00()
  Quest __temp = Self as Quest
  mq204script kmyQuest = __temp as mq204script
  Actor AndrejaREF = Alias_Andreja.GetActorRef()
  Actor BarrettREF = Alias_Barrett.GetActorRef()
  Actor SamCoeREF = Alias_SamCoe.GetActorRef()
  Actor CoraCoeREF = Alias_CoraCoe.GetActorRef()
  Actor SarahMorganREF = Alias_SarahMorgan.GetActorRef()
  Actor VladimirREF = Alias_Vladimir.GetActorRef()
  Actor WalterREF = Alias_WalterStroud.GetActorRef()
  Actor MatteoREF = Alias_MatteoKhatri.GetActorRef()
  Actor VascoREF = Alias_Vasco.GetActorRef()
  Actor NoelREF = Alias_Noel.GetActorRef()
  kmyQuest.MQ204MoveActor(AndrejaREF, LodgeStartMarker)
  kmyQuest.MQ204MoveActor(BarrettREF, LodgeStartMarker)
  kmyQuest.MQ204MoveActor(SamCoeREF, LodgeStartMarker)
  kmyQuest.MQ204MoveActor(CoraCoeREF, LodgeStartMarker)
  kmyQuest.MQ204MoveActor(SarahMorganREF, LodgeStartMarker)
  kmyQuest.MQ204MoveActor(WalterREF, LodgeStartMarker)
  kmyQuest.MQ204MoveActor(MatteoREF, LodgeStartMarker)
  kmyQuest.MQ204MoveActor(VascoREF, LodgeStartMarker)
  kmyQuest.MQ204MoveActor(NoelREF, LodgeStartMarker)
  JemisonGuardShipsEnableMarker.EnableNoWait(False)
  MQ206B.Start()
  NewAtlantisMapMarkerLodge.EnableNoWait(False)
  NewAtlantisMapMarkerCommercialDistrict.EnableNoWait(False)
  NewAtlantisMapMarkerWestEnd.EnableNoWait(False)
  NewAtlantisMapMarkerEmbassy.EnableNoWait(False)
  NewAtlantisMapMarkerResidentialDistrict.EnableNoWait(False)
  MQMisc02.SetStage(10)
  MQ204A_051_LodgeReturnScene.Start()
EndFunction

Function Fragment_Stage_0660_Item_00()
  Self.SetObjectiveCompleted(520, True)
  Self.SetObjectiveDisplayed(530, True, False)
EndFunction

Function Fragment_Stage_0700_Item_00()
  MQ204A_060_HunterGoneScene.Start()
  Game.SetPlayerReportCrime(True)
EndFunction

Function Fragment_Stage_1000_Item_00()
  If MQ201B.GetStageDone(2000) == False && MQ404.GetStageDone(100) == False
    ; SFCP Fix https://www.starfieldpatch.dev/issues/164
    ; These actions should only be carried out if the player goes the foreknowledge route
    ; This avoids any weird conversations when no member of constellation dies. 
    MQ206A.SetStage(5)
    Actor SavedCompanionREF = MQ00_CompanionWhoLives.GetActorRef()
    If SavedCompanionREF == Alias_Andreja.GetActorRef()
      MQ_CompanionSaved.SetValueInt(COM_CompanionID_Andreja.GetValueInt())
    ElseIf SavedCompanionREF == Alias_Barrett.GetActorRef()
      MQ_CompanionSaved.SetValueInt(COM_CompanionID_Barrett.GetValueInt())
    ElseIf SavedCompanionREF == Alias_SamCoe.GetActorRef()
      MQ_CompanionSaved.SetValueInt(COM_CompanionID_SamCoe.GetValueInt())
    ElseIf SavedCompanionREF == Alias_SarahMorgan.GetActorRef()
      MQ_CompanionSaved.SetValueInt(COM_CompanionID_SarahMorgan.GetValueInt())
    EndIf
	  Float currentGameTime = Utility.GetCurrentGameTime()
	  Float cooldownTime = currentGameTime + COM_WantsToTalk_CooldownDays.GetValue()
	  Int I = 0
	  While I < Alias_Companions.Length
	    Alias_Companions[I].GetActorRef().SetValue(COM_WantsToTalk_MQ204_Cooldown, cooldownTime)
	    I += 1
	  EndWhile
	  COM_WantsToTalkEvent_MQ204.Send(None)
	  Game.AddAchievement(6)
  EndIf
  Self.CompleteAllObjectives()
  Self.Stop()
EndFunction

Function Fragment_Stage_2000_Item_00()
  Quest __temp = Self as Quest
  mq204script kmyQuest = __temp as mq204script
  Actor PlayerREF = Game.Getplayer()
  PlayerREF.addtoFaction(EyeBoardingFaction)
  JemisonGuardShipsEnableMarker.EnableNoWait(False)
  Game.SetPlayerReportCrime(True)
  MUSGenesisCombatBoss_MQ204_A_Hunter.Remove()
  NewAtlantisMapMarkerLodge.EnableNoWait(False)
  NewAtlantisMapMarkerCommercialDistrict.EnableNoWait(False)
  NewAtlantisMapMarkerWestEnd.EnableNoWait(False)
  NewAtlantisMapMarkerEmbassy.EnableNoWait(False)
  NewAtlantisMapMarkerResidentialDistrict.EnableNoWait(False)
  UC04_Spaceport_WarningSign_EnableMarker.EnableNoWait(False)
  PlayerREF.RemoveFromFaction(MQ204UCAllyFaction)
  ObjectReference FrontDoorREF = Alias_LodgeFrontDoor.GetRef()
  ObjectReference RoofDoorREF = Alias_LodgeRoofDoor.GetRef()
  ObjectReference FrontDoorExtREF = Alias_LodgeFrontDoorExterior.GetRef()
  ObjectReference RoofDoorExtREF = Alias_LodgeRoofDoorExterior.GetRef()
  FrontDoorREF.BlockActivation(False, False)
  FrontDoorREF.Lock(False, False, True)
  FrontDoorREF.SetLockLevel(0)
  RoofDoorREF.BlockActivation(False, False)
  RoofDoorREF.Lock(False, False, True)
  RoofDoorREF.SetLockLevel(0)
  FrontDoorExtREF.BlockActivation(False, False)
  FrontDoorExtREF.Lock(False, False, True)
  FrontDoorExtREF.SetLockLevel(0)
  RoofDoorExtREF.BlockActivation(False, False)
  RoofDoorExtREF.Lock(False, False, True)
  RoofDoorExtREF.SetLockLevel(0)
  MQ204DoortoLodgeREF.BlockActivation(False, False)
  MQ204DoortoLodgeREF.Lock(False, False, True)
  MQ204DoortoLodgeREF.SetLockLevel(0)
  Actor DeadCompanionREF = MQ00_CompanionWhoDies.GetActorRef()
  DeadCompanionREF.KillEssential(None)
  DeadCompanionREF.Disable(False)
  Actor WalterREF = Alias_WalterStroud.GetActorRef()
  kmyQuest.SetActorRecovered(WalterREF)
  Actor VascoREF = Alias_Vasco.GetActorRef()
  kmyQuest.SetActorRecovered(VascoREF)
  Actor HunterREF = Alias_TheHunter.GetActorRef()
  HunterREF.RemoveSpell(MQ204HunterInvisibility)
  Actor MatteoREF = Alias_MatteoKhatri.GetActorRef()
  Actor VladimirREF = Alias_Vladimir.GetActorRef()
  Actor BarrettREF = Alias_Barrett.GetActorRef()
  Actor SarahREF = Alias_SarahMorgan.GetActorRef()
  Actor SamREF = Alias_SamCoe.GetActorRef()
  Actor CoraREF = Alias_CoraCoe.GetActorRef()
  Actor NoelREF = Alias_Noel.GetActorRef()
  Actor AndrejaREF = Alias_Andreja.GetActorRef()
  If DeadCompanionREF != AndrejaREF
    (SQ_Companions as sq_companionsscript).SetRoleAvailable(AndrejaREF, False)
  EndIf
  If DeadCompanionREF != BarrettREF
    (SQ_Companions as sq_companionsscript).SetRoleAvailable(BarrettREF, False)
  EndIf
  If DeadCompanionREF != SamREF
    (SQ_Companions as sq_companionsscript).SetRoleAvailable(SamREF, False)
  EndIf
  If DeadCompanionREF != SarahREF
    (SQ_Companions as sq_companionsscript).SetRoleAvailable(SarahREF, False)
  EndIf
  (SQ_Crew as sq_crewscript).SetRoleAvailable(VascoREF, False)
  WalterREF.ChangeAnimFaceArchetype(None)
  MatteoREF.ChangeAnimFaceArchetype(None)
  VladimirREF.ChangeAnimFaceArchetype(None)
  BarrettREF.ChangeAnimFaceArchetype(None)
  SarahREF.ChangeAnimFaceArchetype(None)
  SamREF.ChangeAnimFaceArchetype(None)
  CoraREF.ChangeAnimFaceArchetype(None)
  NoelREF.ChangeAnimFaceArchetype(None)
  AndrejaREF.ChangeAnimFaceArchetype(None)
  WalterREF.SetActivateTextOverride(None)
  MatteoREF.SetActivateTextOverride(None)
  VladimirREF.SetActivateTextOverride(None)
  BarrettREF.SetActivateTextOverride(None)
  SarahREF.SetActivateTextOverride(None)
  SamREF.SetActivateTextOverride(None)
  CoraREF.SetActivateTextOverride(None)
  NoelREF.SetActivateTextOverride(None)
  AndrejaREF.SetActivateTextOverride(None)
  NoelREF.SetGhost(False)
  Actor CompanionWhoLivesREF = MQ00_CompanionWhoLives.GetActorRef()
  (SQ_Companions as sq_companionsscript).LockInCompanion(CompanionWhoLivesREF as companionactorscript, False, MQ204CompanionLockInOverMSG, None)
  MQ204_TurnOffCF01Arrest.SetValueInt(0)
  MQ204_WellEnableState.EnableNoWait(False)
  Alias_TheScorpius.GetShipRef().SetGhost(False)
  If COM_SQ01_SonaLeft.GetValueInt() == 1
    Alias_Sona.GetActorRef().EnableNoWait(False)
  EndIf
EndFunction
